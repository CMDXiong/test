Me:
圆弧的Frame算法
1. 先求整圆Frame边界，即圆的四个轴极点 (R,0), (0,R), (-R,0), (0,-R) 
2. 添加圆弧首尾两个端点 (Xs,Ys), (Xe,Ye)，s表示开始start，e表示结束end
3. 检查各个轴极点是否在圆弧上。是则留下，否则扔掉。
    辨别轴极点是否在圆弧上的方法是，角度（angv）是否介于首尾端点的角度之间（angs， ange） （建立子函数：isPonArc（ORG，Ps, Pe, Pv）
    角度的定义为（该点与圆心的线段）与（正X轴）夹角，需要限制在[0,360)之间。（建立算角子函数：angOP(ORG, P)。
    （注意：所有函数名含angle则使用角度单位，所有ang使用弧度单位。）
4. 对留下的所有点，分别遍历取Xmin，Ymin，Xmax，Ymax。
5. 圆弧的Frame即为(Xmin,Ymin), (Xmax,Ymax)确定。
看看有什么问题。
Me:
@潘雄 你的问题：“一个图元与栅格相交，在栅格里面，包含栅格,三个算法有吗？”
不是太明白你的意思。这个栅格是否是指Frame边框？
因为有另外一个名词定义为Grid格点，即显示帮助定位的小格点。
我们可以先统一一下中文名称。
Me:
旋转的椭圆边框，可以先粗略通过正常椭圆的边框旋转来得到。
太复杂好像没有必要。我们主要能够快速判断图形是否有交集等即可。
Me:
@吴竹 我只是在想，有没有必要数据结构里面存储两个Frame？
一个是旋转之前的，一个是旋转之后的。
不是很确定，你的经验怎么觉得？
吴竹:
Frame正常情况应该只有一个，就是最后的状态。在三维里面，一般都是实时计算出来，并不保存。因为随着坐标的变换边界也会变。不过我觉得版图不会变换那么频繁，可以保存最后一个
吴竹:
变换之前的我觉得没有必要保留，感觉没有啥用
Me:
蓝色为正常椭圆边框，黄色为旋转之后的原边框的边框。
测试图形是否与椭圆有交集，先判断是否在黄色框内。如果在内，再判断是否在蓝色边框内.
你有更好的算法么？
吴竹:
没有，不过那个旋转后的明显不是包围盒，可以先做这个，等找到更精确的在完善
Me:
是。我并不希望对于椭圆使用太复杂的算法来求得绝对精确解。
我们是在做工程，并非数学理论。简单快速解决问题即可。
吴竹:
从数学上可以算出四个极点
Me:
我仔细想了想，有没有必要对于Frame边框的数据结构也加上旋转角度信息？好像也不是太好。
正常边框：（X1，Y1）到（X2，Y2）的Box：
Me:
那么旋转就需要加上（Ox，Oy）和ANGLE两项
Me:
再想想，好像还不如直接将所有边框定义为Polygon多边形。
好像Polygon定义边框的思路不错。Box同时也是一个四点的多边形。
虽然存储多了两个点，但是通用型和方便性好很多。
你觉得怎么样？
吴竹:
box本是四个点，以前讨论过，如果采用两个点，旋转后就失去了依据了
吴竹:
其实就是一个多边形，只是固定4个点
Me:
那么问题解决了。
椭圆就全部用图中蓝色的边框即可，没有问题。
吴竹:
椭圆边框是可以，计算正确的包围盒却不行，不过可以先用椭圆的边框frame来测算与栅格的交集
Me:
好。你们的栅格是指什么？
吴竹:
建立选中的查找索引，就是把一个图形区域分成N多个小区域
吴竹:
每个小区域就是一个栅格
Me:
这个是你们的专用名称吗？
吴竹:
我是这么叫的，不知道是否专业
吴竹:
grid
吴竹:
英语是grid
Me:
grid在显示的时候也需要，那个就叫格点吧。隐藏格点，显示格点。
Me:
如果是指区域，那么叫栅格就不错。
吴竹:
这个属于建立选中索引的，当然也可以显示出来
吴竹:
一个grid就是一小块区域，如果图元与这个区域有交集或者包含，则属于这个栅格
Me:
好吧，我们分情况，分别称格点或栅格。
吴竹:
嗯，怎么叫都无所谓，只要我们明白就行，当然如果有更好专业称呼则更好
Me:
不过box存为四个点还是很费存储空间的。很多版图会有大量的box。这时储存空间还是很重要的。
吴竹:
两个点定义的没法旋转，至于空间和效率以后在优化
Me:
我仔细想了想，应该这个方案比较好：如果只有两个点，我们就存为box；如果旋转以后就自动变成4点的多边形polygon储存。这样，又保证储存空间，又不失特殊性。是否可行？
吴竹:
方案上可行的，不过做起来就有些复杂了，因为在每次旋转操作的时候要检测box是否涉及到
Me:
LEdit版图软件是有大量box，并且可以选择是否转换成polygon。
Me:
每次旋转肯定box就变polygon了。polygon找旋转就没有区别了。看起来没有问题
吴竹:
我们可以把这个box定义采用两个点的这个方案可以保留一下，以后如果遇到这个情况或者内存的确比较大的时候考虑采用这个方案，现在先不要这么做
Me:
确定LEdit有box的两点定义。你看看KLayout和日本人的代码是怎么定义的？基础框架很重要，以后改的话太费时间功夫。
吴竹:
这个定义不会有太多的功夫，因为我们并不改接口只会修改里面的实现。我先看看他们的定义
CMD:
刚刚在午休
CMD:
@邓恒华 @吴竹 可以将栅格和这个背景的格子，统一起来吗？
吴竹:
概念上，这应该是两码事吧，不过你实现的时候可以参考
CMD:
那我们就分开吧，不要杂柔在一起了
Me:
我们先把三个定义分开：Frame（边框），Grid（栅格），Grid（格点）。
开会时记得谈论统一一下。